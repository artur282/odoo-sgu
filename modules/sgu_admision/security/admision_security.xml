<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="0">
        <!-- Módulo de Admisión -->
        <record id="module_admision" model="ir.module.category">
            <field name="name">Sistema de Admisión</field>
            <field name="sequence">10</field>
        </record>

        <!-- Grupos de Usuario -->
        <record id="group_aspirante" model="res.groups">
            <field name="name">Aspirante</field>
            <field name="category_id" ref="module_admision"/>
            <field name="comment">Aspirante que puede realizar preinscripción en línea</field>
            <field name="implied_ids" eval="[(4, ref('base.group_portal'))]"/>
        </record>

        <record id="group_estudiante" model="res.groups">
            <field name="name">Estudiante</field>
            <field name="category_id" ref="module_admision"/>
            <field name="comment">Estudiante regular que puede consultar sus datos y horarios</field>
            <field name="implied_ids" eval="[(4, ref('base.group_portal'))]"/>
        </record>

        <record id="group_operador" model="res.groups">
            <field name="name">Operador</field>
            <field name="category_id" ref="module_admision"/>
            <field name="comment">Operador que puede validar documentos e inscribir estudiantes</field>
            <field name="implied_ids" eval="[(4, ref('base.group_user'))]"/>
        </record>

        <record id="group_operador_admin" model="res.groups">
            <field name="name">Operador Admin</field>
            <field name="category_id" ref="module_admision"/>
            <field name="comment">Operador con capacidad para realizar preinscripciones e inscripciones</field>
            <field name="implied_ids" eval="[(4, ref('group_operador'))]"/>
        </record>

        <record id="group_operador_autoridad" model="res.groups">
            <field name="name">Operador Autoridad</field>
            <field name="category_id" ref="module_admision"/>
            <field name="comment">Puede autorizar cambios de núcleo, carrera e inscripciones No OPSU</field>
            <field name="implied_ids" eval="[(4, ref('group_operador_admin'))]"/>
        </record>

        <record id="group_admin" model="res.groups">
            <field name="name">Coordinador Sectorial</field>
            <field name="category_id" ref="module_admision"/>
            <field name="comment">Coordinador con privilegios para asignar roles y gestionar procesos</field>
            <field name="implied_ids" eval="[(4, ref('group_operador_admin'))]"/>
        </record>

        <record id="group_super_usuario" model="res.groups">
            <field name="name">Dirección DACE</field>
            <field name="category_id" ref="module_admision"/>
            <field name="comment">Acceso total al módulo de admisión</field>
            <field name="implied_ids" eval="[(4, ref('group_admin')), (4, ref('base.group_system'))]"/>
        </record>

        <!-- Reglas de registro -->
        <record id="rule_personal_aspirante" model="ir.rule">
            <field name="name">Aspirante: acceso solo a datos propios</field>
            <field name="model_id" ref="model_admision_aspirante"/>
            <field name="domain_force">[('partner_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_aspirante'))]"/>
        </record>

        <record id="rule_personal_preinscripcion" model="ir.rule">
            <field name="name">Aspirante: acceso solo a preinscripción propia</field>
            <field name="model_id" ref="model_admision_preinscripcion"/>
            <field name="domain_force">[('aspirante_id.partner_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_aspirante'))]"/>
        </record>

        <record id="rule_personal_inscripcion" model="ir.rule">
            <field name="name">Estudiante: acceso solo a inscripción propia</field>
            <field name="model_id" ref="model_admision_inscripcion"/>
            <field name="domain_force">[('aspirante_id.partner_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_estudiante'))]"/>
        </record>

        <!-- Reglas para Periodo Académico -->
        <record id="rule_periodo_academico_estudiante" model="ir.rule">
            <field name="name">Estudiante: acceso a periodos activos</field>
            <field name="model_id" ref="model_admision_periodo"/>
            <field name="domain_force">[('active', '=', True)]</field>
            <field name="groups" eval="[(4, ref('group_estudiante'))]"/>
        </record>

        <record id="rule_periodo_academico_aspirante" model="ir.rule">
            <field name="name">Aspirante: acceso a periodos activos</field>
            <field name="model_id" ref="model_admision_periodo"/>
            <field name="domain_force">[('active', '=', True)]</field>
            <field name="groups" eval="[(4, ref('group_aspirante'))]"/>
        </record>

        <record id="rule_periodo_academico_operador" model="ir.rule">
            <field name="name">Operador: acceso a periodos</field>
            <field name="model_id" ref="model_admision_periodo"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_operador'))]"/>
        </record>

        <record id="rule_periodo_academico_global" model="ir.rule">
            <field name="name">Regla global: periodos activos para todos</field>
            <field name="model_id" ref="model_admision_periodo"/>
            <field name="global" eval="True"/>
            <field name="domain_force">['|', ('active', '=', True), ('active', '=', False)]</field>
        </record>
    </data>
</odoo>